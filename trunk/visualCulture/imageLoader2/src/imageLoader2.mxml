<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					   xmlns:s="library://ns.adobe.com/flex/spark" 
					   xmlns:mx="library://ns.adobe.com/flex/halo"
					   width="800" height="600">
	<fx:Script>
		<![CDATA[
			import spark.primitives.BitmapImage;
			
			import views.ImgPanel;
			
			private var imageLoader: ImageLoader = new ImageLoader;
			
			private function displayImages( ):void 
			{
				for each( var img:BitmapImage in imageLoader.images ) {
					var pnl1:ImgPanel = new ImgPanel();
					img.horizontalCenter = 0;
					img.verticalCenter = 0;
					pnl1.addElement(img);
					pnl1.swapElementsAt(0, 1);
					//pnl1.img_.source =  e.target.content;
					
					var group1:Group = new Group();
					group1.x = 100+Math.random()*600;
					group1.y = 100+Math.random()*400;
					group1.addElement(pnl1);
					//group1.cacheAsBitmap = true;
					this.thumbnailsList.addElement(group1);
					
				}
				count.text = imageLoader.images.length.toString();//imageLoader.counter.toString();
			}
			
			private function deleteImages():void {
				imageLoader.Delete();
 			
				for (var i:int=0; i<this.thumbnailsList.numElements; i++) {
					((Group)(this.thumbnailsList.getChildAt(i))).getChildAt(0).removeElementAt(0);
				}
				while (this.thumbnailsList.numElements > 0) {
					this.thumbnailsList.removeElementAt(0);
				}
			}
			
			private function rotateTest():void {
				for (var i:int=0; i<this.thumbnailsList.numElements; i++) {
					((Group)(this.thumbnailsList.getChildAt(i))).rotationZ = rotZ.value;
				}
			}
		]]>
	</fx:Script>
	
	
	<s:VGroup width="100%" height="100%">
		<s:HGroup>
			<s:Button label="load images" click="{imageLoader.Load( '/AsianCult/SWS02/projects/resized' )}" />
			<s:Button label="delete images" click="{deleteImages()}" />
			<s:Button label="display" click="{displayImages()}" />
			<s:Button label="Button" click="{rotateTest()}"/>
			<s:HSlider id="rotZ" minimum="0" maximum="360" value="0" change="{rotateTest()}"/>
			<s:Label id="count" />
		</s:HGroup>
		<s:Scroller  width="100%" height="100%" >
			<s:Group id="thumbnailsList" width="100%" height="100%">
			</s:Group>
			<!--s:Group id="thumbnailsList" width="100%" columnWidth="72" rowHeight="72" /-->
		</s:Scroller>
	</s:VGroup>
</s:WindowedApplication>